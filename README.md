Update version 3: final, gọn gàng hơn, đầy đủ comment tiếng Việt cho các chức năng.